typedef
int
Q;
typedef
unsigned
R;
typedef
struct
{
Q
N,
S,
P,
T,
U,
V;
}
W;
R
_;
R
N(
R
X)
{
R
Y=
2,
Z;
for
(;
 Y
;
Y*=
Y)
{
Z=
-1
/-
~Y
;
X=
(X
/Y
&Z
)+
(X
&Z
)*
(Y
*_
-~-
_)
;
}
return
X;
}
W
S(
W
a)
{
W
B;
_=
1;
B.
N=
N(
a.
S)
;
B.
S=
N(
a.
N)
;
B.
P=
N(
a.
P)
;
B.
U=
-1
<<
30
;
B.
V=
-a
.U
;
return
B;
}
Q
P(
Q
Y,
Q
b,
R
c)
{
Q
E=
Y+
(b
+8
)%
10
-5
+Y
/4
%2
&31
;
return
c
>>E&1||
Y/
4-
E/
4-
~-
(b
&2
)?
-1
:E
;
}
Q
T(
W
B,
Q
a,
Q
b)
{
Q
E=
P(
a,
b,
B.
N)
;
return~
E?
B.
S
>>E&1?
~P
(E
,b
,B.
S|
B.
N)
?128
|b
*32
|a
:-
1:
b*
32
|a
:E
;
}
Q
U(
W
B,
R
c,
Q
Y)
{
Q
E,
b;
for(E=32; E--; )if(
(B.
N&
c)
>>E&1)
for(b=2<< (B. P >>E&1); b--; )if(
T(
B,
E,
b)
>=
Y<<
7)
return
1;
return
0;
}
W
V(
W
B,
Q
Z)
{
R
E=
Z&
31
,b
=Z
/32
&3
,Y
=B.
T=
P(
E,
b,
0)
,K
=1
<<
Y;
B.
N|=
K;
B.
P&=
~K
;
B.
P|=
(B.
P
>>E&1)
<<
Y;
_=
B.
S
>>E&1&&
U(
B,
K,
1)
;
B.
P|=
K&-
1<<
28
;
B.
N&=
E=
~(
1<<
E)
;
B.
P&=
E;
B.
S&=
E;
return
Z>>
7?
V(
B,
b<<
5|
Y)
:B
;
}
W
d(
W
B,
Q
b)
;
R
e;
W
f(
W
B,
Q
E,
Q
b,
Q
g)
{
Q
h,
i=
0,
I,
j,
K,
k,
Z,
Y;
for(h=2<< (B. P >>E&1); h--; ){
j=
T(
B,
E,
h)
;
if(~
j&&
j>>
7!=
!~
g)
{
++
i;
if(
B.
U<=
B.
V)
{
W
O;
O=
V(
B,
j)
;
K=
g<
0?
j:
g;
++
e;
I=
_?
f(
O,
O.
T,
b,
K)
.U
:(
Y=
b+
U(
O=
S(
O)
,-
1,
1)
)?
-(
d(
O,
~-
Y)
.U
):
(_
=0
,Z
=N(O.N)+3*N(O.N&O.P),
k
=N(O.S)+3*N(O.S&O.P),
(k
-Z
<<
 24
)/
(k
+Z
)+
(short
)rand
()
);
if(
I>=
B.
U)
{
B.
U=
I;
B.
T=
K;
}
}
}
}
_=
i;
return
B;
}
W
d(
W
B,
Q
b)
{
Q
E=
32
,Y
=
~U
(B
,-
1,
1)
;
for
(;
E--
&&
B.
U<=
B.
V;
)if(
B.
N
>>E&1)
{
B=
f(
B,
E,
b,
Y)
;
}
return
B;
}
char
l[
4095
],
*O
=l
,*
b;
char
*I
(char
*X
){
Q
Z=
1,
W=
0,
E,
M=
0,
B;
b=
O;
for
(;
 E
=
*X
++
;
){
E=
E%
65
%6
^2
;
M+=
B=
Z+
1+
E/
4;
W=
W<<
B^
E;
Z=
E<
2;
for(E=M/ 7; E--; )
{
M%=
7;
W^=
(*
O++=
W>>
M)
<<
M;
}
}
*O
++=
0;
return
b;
}
Q
main
()
{
Q
K,
Y,
E,
m,
n,
o=
4,
g,
b,
Z;
W
B;
srand
(clock
()
);
B.
S=
(B.
N=
4095
)<<
20
;
B.
P=
0;
for
(;
;
){
for(K=8; K--; )
{
for(Y=8; Y--; )
{
E=
K*
4+
Y/
2;
printf( I("	      	 }	{ 	}"
)+
(K
^Y
^1
)%
2*
2,
".xoXO"
[(
B.
P
>>E&1)
*2
+(
B.
S
>>E&1)
*2
+(
B.
N
>>E&1)
])
;
}
printf( I("	   } }		} }	} }  		 "
),
-~
E)
;
}
for(g=1; g--; )
{
O=
l;
printf( I("}	 }	} }	{ }    	  }	}	} {  ;  ;			}"
)+
o/
2*
2)
;
e=
0;
if(
o<
4)
B=
S(
B)
;
if(!
U(
B,
-1
,0
))
{
printf( I("	  	}	} {	;	{ ;	 }	; 	}	  } 		 "
))
;
return
0;
}
printf( I("	  	{  {	;	{ ;		 ;		 {	 ; ;	{	{ }  	}  ; ; { } 	   } }	; 	; 	 {	 ;	 }	} }	{ 	;		 {	 ; ;	{	{ ; } }   "
)+
(o
&1
)*
13
,I
("   	}			{		{	}	;   }   "
)+
U(
B,
-1
,1
))
;
if(
o&
4)
{
o&
1?
scanf
("%d"
,&
n)
:(
scanf
("%d%d"
,&
m,
&n
),
--
m)
;
Z=
B.
N>>
m&
1?
T(
B,
m,
n)
:-
1;
if(
g=
Z>>
7!=
U(
B,
-1
,1
))
{
printf( I("{	 ; { {	} { }	{ ;	}  ; {  		 "
))
;
}
}
else
{
B.
U=
-(
B.
V=
1<<
30
);
for
(b
=4
;
e<
65536
&&
b<
20
;
b++
){
Z=
(o
&1
?f
(B
,m
,b
,-
2)
:d
(B
,b
))
.T
;
}
o&
1?
printf( I("	 }	{ }  		 "
),
Z>>
5&
3^
3)
:printf( I(
"	 }	{ } 	   } }	{ }  		 "
),
32
-(
Z&
31
),
Z>>
5&
3^
3)
;
}
}
B=
V(
B,
Z)
;
g=
o;
if(
_)
{
o|=
1;
m=
B.
T;
}
else
{
o=
o/
2*
2^
4;
}
if(
g<
4)
{
B=
S(
B)
;
}
}
}
