 typedef struct A*B,*(*C)();struct A{C(*d)();B e;}*v(),*b;C n[256];
C f(f,g,h,i)C f,g,h,i;{return f;}
C g(f,g,h,i)C f,g,h,i;{return g;}
C h(f,g,h,i)C f,g,h,i;{return h;}
C i(f,g,h,i)C f,g,h,i;{return i;}
B j();B j f(d,e)B d,e;{return d;}B j g(d,e)B d,e;{return d;}B j h(d,e)B d,e;{return j (d->e);}B j i(d,e)B d,e;{return j (d->e);}B j(d,e)B d,e;{return (*(*d->d)(j f,j g,j h,j i))(d,e);}
B k();B k f(d,e)B d,e;{return d;}B k g(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=h,b->e=d,b);}B k h(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=h,b->e=d,b);}B k i(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=h,b->e=d,b);}B k(d,e)B d,e;{return (*(*d->d)(k f,k g,k h,k i))(d,e);}
B l();B l f(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=i,b->e=d,b);}B l g(d,e)B d,e;{return d;}B l h(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=i,b->e=d,b);}B l i(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=i,b->e=d,b);}B l(d,e)B d,e;{return (*(*d->d)(l f,l g,l h,l i))(d,e);}
B m();B m f(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=g,b->e=d,b);}B m g(d,e)B d,e;{return (b=(B)malloc(sizeof(*b)),b->d=f,b->e=d,b);}B m h(d,e)B d,e;{return l(m (d->e));}B m i(d,e)B d,e;{return k(m (d->e));}B m(d,e)B d,e;{return (*(*d->d)(m f,m g,m h,m i))(d,e);}
B p();B p f(d,e)B d,e;{return d;}B p g(d,e)B d,e;{return l(m(d));}B p h(d,e)B d,e;{return k(p (d->e));}B p i(d,e)B d,e;{return l(m (d->e));}B p(d,e)B d,e;{return (*(*d->d)(p f,p g,p h,p i))(d,e);}
B q();B q f(d,e)B d,e;{return l(p(d));}B q g(d,e)B d,e;{return m(d);}B q h(d,e)B d,e;{return l (d->e);}B q i(d,e)B d,e;{return k(q (d->e));}B q(d,e)B d,e;{return (*(*d->d)(q f,q g,q h,q i))(d,e);}
B r();B r f(d,e)B d,e;{return m(d);}B r g(d,e)B d,e;{return k(mf (d->e));}B r h(d,e)B d,e;{return l(r (d->e));}B r i(d,e)B d,e;{return k (d->e);}B r(d,e)B d,e;{return (*(*d->d)(r f,r g,r h,r i))(d,e);}
B s();B s f(d,e)B d,e;{return d;}B s g(d,e)B d,e;{return e;}B s h(d,e)B d,e;{return (B)printf("0",s (d->e));}B s i(d,e)B d,e;{return (B)printf("1",s (d->e));}B s(d,e)B d,e;{return (*(*d->d)(s f,s g,s h,s i))(d,e);}
B t();B t f(d,e)B d,e;{return d;}B t g(d,e)B d,e;{return p(e);}B t h(d,e)B d,e;{return k(t((d->e),e));}B t i(d,e)B d,e;{return v(k(t((d->e),e)),e);}B t(d,e)B d,e;{return (*(*d->d)(t f,t g,t h,t i))(d,e);}
B u();B u f(d,e)B d,e;{return k(e);}B u g(d,e)B d,e;{return l(r(e));}B u h(d,e)B d,e;{return k(v((d->e),e));}B u i(d,e)B d,e;{return l(v((d->e),e));}B u(d,e)B d,e;{return (*(*d->d)(u f,u g,u h,u i))(d,e);}
B v();B v f(d,e)B d,e;{return e;}B v g(d,e)B d,e;{return r(e);}B v h(d,e)B d,e;{return u(e,(d->e));}B v i(d,e)B d,e;{return u(q(e),(d->e));}B v(d,e)B d,e;{return (*(*d->d)(v f,v g,v h,v i))(d,e);}
B w();B w f(d,e)B d,e;{return (B)printf("0");}B w g(d,e)B d,e;{return d;}B w h(d,e)B d,e;{return s(d);}B w i(d,e)B d,e;{return s(d);}B w(d,e)B d,e;{return (*(*d->d)(w f,w g,w h,w i))(d,e);}
B x();B x f(d,e)B d,e;{return (*n[getchar()])(d);}B x g(d,e)B d,e;{return (B)printf("-1");}B x h(d,e)B d,e;{return w(p(d,(B)printf("-")));}B x i(d,e)B d,e;{return xh(d);}B x(d,e)B d,e;{return (*(*d->d)(x f,x g,x h,x i))(d,e);}
B y();B y f(d,e)B d,e;{return xf(mg());}B y g(d,e)B d,e;{return v(d,p(yf()));}B y h(d,e)B d,e;{return v(d,yf());}B y i(d,e)B d,e;{return t(d,yf());}B y(d,e)B d,e;{return (*(*d->d)(y f,y g,y h,y i))(d,e);}
B z();B z f(d,e)B d,e;{return xf(yf());}B z g(d,e)B d,e;{return (*(*j(d)->d)(w,x))(d);}B z h(d,e)B d,e;{return xf(k(d));}B z i(d,e)B d,e;{return xf(l(d));}B z(d,e)B d,e;{return (*(*d->d)(z f,z g,z h,z i))(d,e);}
main(){
n['(']=zf;n['x']=yi;n['-']=yg;
n['+']=yh;n['0']=zh;n['1']=zi;
n[' ']=xf;n[')']=n['\n']=kf;
(B)printf("\n",zg(yf()));}
