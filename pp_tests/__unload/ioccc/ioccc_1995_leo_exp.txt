    Ar *U, *Au, W, Li, F;
Mo Al[27];
S
{
  Ar V, K, U, T;
  S *H;
}
*C, *Zn;
S *
Zr (Mo V, Mo K, Mo T)
{
  S *O = C, *W = Zn;
  *((U [(K)*Ga/32+V/32]>>(V&31)&1)?&W:&O)=0;
  while (O)
    O = (W = !O-> T || (O-> T &= -!!(O-> V - V | O-> K - K | !(T - O-> T ^ 1))) ? O : 0) ? O-> H : 0;
  return W;
}
void
Ag (Mo V, Mo K, Mo P, Mo T, S * O)
{
  S *H = (O ? O-> H : C);
  *(H ? &O : &Zn) = O = *(O ? &O-> H : &C) = calloc(sizeof (S),1);
  O-> U = P; O-> T = T; O-> H = H; O-> V = V; O-> K = K;
  F & 32 || (U [(K)*Ga/32+V/32]|=1<<(V&31));
}
void
main (Mo V, char ** O)
{
  char *H, Sg[106];
  srand (time (0));
  while (*++O && (sscanf (*O, "%lu", W ? &Li : &W) ||
    (--**O, F |= !((**O - 57) % 14) << (**O - 57) / 14))
  );
  puts("%!\n/S{ 0 setlinewidth} /N{ showpage} /O{ moveto rlineto stroke} def def def S");
  for (V = 0; V < 8; Al[8 | (V - 2) & 7] = Al[V] = !!(V & 3) * (1 - (V & 4) / 2) * 4, V++);
  do
    {
      U = calloc(V = (As * Ga + 31) / 8,1);
      Au = calloc(V,1);
      for (*U = -W-1, H = calloc(W,1); ++*U; H[*U+W] = (V=rand()%100,(V>=Li/2)+(V<Li)-(V<Li/2)));
      Ag (Ga / 2, As / 2, 5, 1, C);
      Ag (Ga / 2, As / 2, 1, 1, C);
      while (C) {
 Ar I[7], Y[5], D[13];
 S *Ge, *O = C;
 if (O-> T)
   {
     D[8] = (F & 4 ? (V=rand()%100,(V>=Li/2)+(V<Li)-(V<Li/2)) : W ? H[O-> T % W] : (O-> T & 85) % 3);
     4-2*(!!C>>!C)-D[8]&&(I[(!!C>>!C)]=O-> V+Al[0|O-> U+(!!C>>!C)+(!!C>>!C)-1&7],Y[(!!C>>!C)]=O-> K+Al[8|O-> U+(!!C>>!C)+(!!C>>!C)-1&7],D[(!!C>>!C)]=((O-> V^I[(!!C>>!C)]&&O-> K^Y[(!!C>>!C)]&&I[(!!C>>!C)]<Ga&&Y[(!!C>>!C)]<As)?D[0]=(Au [(O-> K<Y[(!!C>>!C)]?O-> K:Y[(!!C>>!C)])*Ga/32+(O-> V<I[(!!C>>!C)]?O-> V:I[(!!C>>!C)])/32]>>((O-> V<I[(!!C>>!C)]?O-> V:I[(!!C>>!C)])&31)&1),F&2||(Au [(O-> K<Y[(!!C>>!C)]?O-> K:Y[(!!C>>!C)])*Ga/32+(O-> V<I[(!!C>>!C)]?O-> V:I[(!!C>>!C)])/32]|=1<<((O-> V<I[(!!C>>!C)]?O-> V:I[(!!C>>!C)])&31)),D[0]:0),printf("%d %d %lu %lu O ",Al[0|O-> U+(!!C>>!C)+(!!C>>!C)-1&7]>>D[(!!C>>!C)],Al[8|O-> U+(!!C>>!C)+(!!C>>!C)-1&7]>>D[(!!C>>!C)], O-> V, O-> K));
     4-2*(!!C<<!!C)-D[8]&&(I[(!!C<<!!C)]=O-> V+Al[0|O-> U+(!!C<<!!C)+(!!C<<!!C)-1&7],Y[(!!C<<!!C)]=O-> K+Al[8|O-> U+(!!C<<!!C)+(!!C<<!!C)-1&7],D[(!!C<<!!C)]=((O-> V^I[(!!C<<!!C)]&&O-> K^Y[(!!C<<!!C)]&&I[(!!C<<!!C)]<Ga&&Y[(!!C<<!!C)]<As)?D[0]=(Au [(O-> K<Y[(!!C<<!!C)]?O-> K:Y[(!!C<<!!C)])*Ga/32+(O-> V<I[(!!C<<!!C)]?O-> V:I[(!!C<<!!C)])/32]>>((O-> V<I[(!!C<<!!C)]?O-> V:I[(!!C<<!!C)])&31)&1),F&2||(Au [(O-> K<Y[(!!C<<!!C)]?O-> K:Y[(!!C<<!!C)])*Ga/32+(O-> V<I[(!!C<<!!C)]?O-> V:I[(!!C<<!!C)])/32]|=1<<((O-> V<I[(!!C<<!!C)]?O-> V:I[(!!C<<!!C)])&31)),D[0]:0),printf("%d %d %lu %lu O ",Al[0|O-> U+(!!C<<!!C)+(!!C<<!!C)-1&7]>>D[(!!C<<!!C)],Al[8|O-> U+(!!C<<!!C)+(!!C<<!!C)-1&7]>>D[(!!C<<!!C)], O-> V, O-> K));
     (1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))&&I[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))]<Ga&&Y[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))]<As&&!D[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))]&&(Ge=Zr(I[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))],Y[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))],O-> T+1))&&!(U [(Y [(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))])*Ga/32+I[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))]/32]>>(I[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))]&31)&1)&&(Ag(I[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))],Y[(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))],(O-> U+2*(1 + D[8] / 2 + ((1 - ( F & 24 && (F & 16 || O-> T & 1))) & D[8]))-3)&7,O-> T+1,F&24?C:Ge),0);
     ((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))&&I[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))]<Ga&&Y[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))]<As&&!D[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))]&&(Ge=Zr(I[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))],Y[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))],O-> T+1))&&!(U [(Y [((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))])*Ga/32+I[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))]/32]>>(I[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))]&31)&1)&&(Ag(I[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))],Y[((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))],(O-> U+2*((1 + (F & 24 && (F & 16 || O-> T & 1))) & -(D[8] & 1))-3)&7,O-> T+1,F&24?C:Ge),0);
   }
 free((C = O-> H, O));
      }
      fgets(Sg, 2, stdin);
      puts ("N S");
      fflush (stdout);
      free (H);
      free (U);
      free (Au);
    }
  while (!(!(W >> 1) | F & 1));
}
